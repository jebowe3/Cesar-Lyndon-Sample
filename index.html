<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <title>Cesar Lyndon Sample</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
  <script src="data/newport-historic-buildings.geojson"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
    }

    body,
    table,
    tr,
    td,
    th,
    div,
    h1,
    h2,
    input {
      font-family: "Calibri", "Trebuchet MS", "Ubuntu", Serif;
      font-size: 11pt;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }

    /* full size */
    .ctl {
      padding: 2px 10px 2px 10px;
      background: white;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      border-radius: 5px;
      text-align: right;
    }

    .title {
      font-size: 18pt;
      font-weight: bold;
    }

    .src {
      font-size: 10pt;
    }
  </style>

</head>

<body>

  <div id="map"></div>

  <script>
    /* **** Leaflet **** */

    // Base layers
    //  .. OpenStreetMap
    var osm1 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
      minZoom: 0,
      maxZoom: 5
    });

    var osm2 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
      minZoom: 9,
      maxZoom: 14
    });

    var osm3 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
      minZoom: 13,
      maxZoom: 18
    });

    // Overlay layers (TMS)
    var northAm1775 = L.tileLayer('north-america-map-1775/{z}/{x}/{y}.png', {
      tms: true,
      opacity: 0.7,
      attribution: "",
      minZoom: 0,
      maxZoom: 5
    });

    var narragansettBay1777 = L.tileLayer('narragansett-bay-map-1777/{z}/{x}/{y}.png', {
      tms: true,
      opacity: 0.7,
      attribution: "",
      minZoom: 9,
      maxZoom: 14
    });

    // Map
    var map = L.map('map', {
      center: [29.686270915753877, -0.0010059200998426832],
      zoom: 5,
      minZoom: 0,
      maxZoom: 18
    });

    var nphistbldgs = L.geoJson(newportbldgs, {
      // style the layer
      style: function(feature) {

        return {
          color: 'black',
          opacity: 0.35,
          weight: 1.0,
          fillColor: 'blue',
          fillOpacity: 0.35,
        };
      },
      // for each feature...
      onEachFeature: function(feature, layer) {
        var address = layer.feature.properties.address;
        var year = layer.feature.properties.year;
        var comments = layer.feature.properties.Comments;
        var page = layer.feature.properties.page;
        // bind a popup window
        layer.bindPopup(address + '<br>' + 'Year Built: ' + year + '<br>' + 'Comments: ' + comments + '<br>' + '<a href="' + page + '" target="_blank">PVA Link</a>');

        layer.on('mouseover', function () {
          this.setStyle({
            color: 'black',
            opacity: 0.75,
            weight: 1.0,
            fillColor: 'yellow',
            fillOpacity: 0.75,
          });
        });
        layer.on('mouseout', function () {
          this.setStyle({
            color: 'black',
            opacity: 0.35,
            weight: 1.0,
            fillColor: 'blue',
            fillOpacity: 0.35,
          });
        });
      }
    });

    var na1775 = L.layerGroup([osm1, northAm1775]).addTo(map);
    var nb1777 = L.layerGroup([osm2, narragansettBay1777]);
    var newportbs = L.layerGroup([osm3, nphistbldgs]);


    var basemaps = {
      "North America, 1775": na1775,
      "Narragansett Bay, 1777": nb1777,
      "Newport Historic Buildings": newportbs,
    }
    /*
    var overlaymaps = {
      "Layer": northAm1775
    }
    */
    // Title
    var title = L.control();
    title.onAdd = function(map) {
      this._div = L.DomUtil.create('div', 'ctl title');
      this.update();
      return this._div;
    };
    title.update = function(props) {
      this._div.innerHTML = "Cesar Lyndon Sample";
    };
    title.addTo(map);

    // Note
    var src =
      'Generated by <a href="https://www.klokan.cz/projects/gdal2tiles/">GDAL2Tiles</a>, Copyright &copy; 2008 <a href="https://www.klokan.cz/">Klokan Petr Pridal</a>,  <a href="https://www.gdal.org/">GDAL</a> &amp; <a href="https://www.osgeo.org/">OSGeo</a> <a href="https://code.google.com/soc/">GSoC</a>';
    var title = L.control({
      position: 'bottomleft'
    });
    title.onAdd = function(map) {
      this._div = L.DomUtil.create('div', 'ctl src');
      this.update();
      return this._div;
    };
    title.update = function(props) {
      this._div.innerHTML = src;
    };
    title.addTo(map);


    // Add base layers
    L.control.layers(basemaps, null, {
      collapsed: false
    }).addTo(map);

    // Fit to overlay bounds (SW and NE points with (lat, lon))
    map.fitBounds([
      [-5.207696945170733, 179.99794574418985],
      [64.58023877667848, -179.99995758438953]
    ]);

    map.on('baselayerchange', function(e) {
      if (e.name == "Narragansett Bay, 1777") {
        map.fitBounds([
          [41.430505896428556, -71.02716038903907],
          [41.87704215922045, -71.47326921280491]
        ]);
      }
      if (e.name == "North America, 1775") {
        map.fitBounds([
          [-5.207696945170733, 179.99794574418985],
          [64.58023877667848, -179.99995758438953]
        ]);
      }
      if (e.name == "Newport Historic Buildings") {
        map.fitBounds([
          [41.4874, -71.3],
          [41.4952, -71.3294]
        ]);
      }
    });
  </script>

</body>

</html>
